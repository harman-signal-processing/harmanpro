# New harmanpro.com site

# Temporary rewrites back to the old servers, remove these
# when going live...
# Before going live the DNS was:
#   www.harmanpro.com -> 2.19.251.102
#   harmanpro.com -> 75.102.11.225
server {
  listen 80;
  server_name harmanpro.com www.harmanpro.com;
  #rewrite all...
  location / {
    proxy_set_header Host "harmanpro.com";
    proxy_pass http://75.102.11.225;
    proxy_redirect off;
  }
}
# before going live the DNS was:
#   info.harmanpro.com -> 66.172.47.190
server {
  listen 80;
  server_name info.harmanpro.com;
  #rewrite all...
  location / {
    proxy_set_header Host "info.harmanpro.com";
    proxy_pass http://66.172.47.190;
    proxy_redirect off;
  }
}

# Un-comment this when going live...
#server {
#  listen 80;
#  server_name info.harmanpro.com;
#  return 301 $scheme://harmanpro.com$request_uri;
#}
# Need to make sure this is right, with www.harmanpro.com going
# to akamai.
#server {
#  listen 80;
#  server_name harmanpro.com;
#  return 301 $scheme://www.harmanpro.com$request_uri;
#}

server {
  listen 80;
  # placeholder for new site, swap two lines below:
  server_name new2015.harmanpro.com;
  #server_name www.harmanpro.com;
  root /var/www/harmanpro/current/public;
  access_log /var/log/nginx/harmanpro-access.log;
  error_log /var/log/nginx/harmanpro-error.log;

  passenger_enabled on;
  sendfile on;

  location ~ /\.git {
    deny all;
  }

  # pwd protect wite, remove this block when going live...
  location / {
    auth_basic "Restricted";
    auth_basic_user_file /var/www/hmg/htpasswd;
    passenger_enabled on;
  }

  location ~* (?i) /estore.* { return 301 $scheme://shop.harmanpro.com/; }

  location ~* (?i)/index\.htm.* { return 301 $scheme://$http_host/; }
  location ~* (?i)/about\.aspx { return 301 $scheme://$http_host/; }
  location ~* (?i)/SiteMap\.aspx { return 301 $scheme://$http_host/sitemap.xml; }
  location ~* (?i)/TermsofUse\.aspx { return 301 $scheme://$http_host/terms_of_use; }
  location ~* (?i)/PrivacyPolicy\.aspx { return 301 $scheme://$http_host/privacy_policy; }
  location ~* (?i)/TrainingPrograms\.aspx { return 301 $scheme://$http_host/training; }
  location ~* (?i)/Contact\.aspx { return 301 $scheme://$http_host/contacts; }
  location ~* (?i)/Technical\.aspx { return 301 $scheme://$http_host/contacts; }

  location ~* (?i)/brand\.aspx\?brand\=akg { return 301 $scheme://$http_host/brands/akg; }
  location ~* (?i)/brand\.aspx\?brand\=bss { return 301 $scheme://$http_host/brands/bss; }
  location ~* (?i)/brand\.aspx\?brand\=crown { return 301 $scheme://$http_host/brands/crown; }
  location ~* (?i)/brand\.aspx\?brand\=dbx { return 301 $scheme://$http_host/brands/dbx; }
  location ~* (?i)/brand\.aspx\?brand\=jblpro { return 301 $scheme://$http_host/brands/jbl; }
  location ~* (?i)/brand\.aspx\?brand\=lexicon { return 301 $scheme://$http_host/brands/lexicon; }
  location ~* (?i)/brand\.aspx\?brand\=martin { return 301 $scheme://$http_host/brands/martin; }
  location ~* (?i)/brand\.aspx\?brand\=soundcraft { return 301 $scheme://$http_host/brands/soundcraft; }
  location ~* (?i)/brand\.aspx\?brand\=studer { return 301 $scheme://$http_host/brands/studer; }

  location ~* (?i)/market\.aspx\?market\=HouseofWorship { return 301 $scheme://$http_host/applications/worship; }
  location ~* (?i)/market\.aspx\?market\=Sports { return 301 $scheme://$http_host/applications/installed; }
  location ~* (?i)/market\.aspx\?market\=PerformingArts { return 301 $scheme://$http_host/applications/installed; }
  location ~* (?i)/market\.aspx\?market\=ThemedAttraction { return 301 $scheme://$http_host/applications/installed; }
  location ~* (?i)/market\.aspx\?market\=Commercial { return 301 $scheme://$http_host/applications/installed; }
  location ~* (?i)/market\.aspx\?market\=ConventionCenter { return 301 $scheme://$http_host/applications/installed; }
  location ~* (?i)/market\.aspx\?market\=Transportation { return 301 $scheme://$http_host/applications/transportation; }
  location ~* (?i)/market\.aspx\?market\=NightClub { return 301 $scheme://$http_host/applications/nightclubs; }
  location ~* (?i)/market\.aspx\?market\=PortablePA { return 301 $scheme://$http_host/applications/live-sound; }
  location ~* (?i)/market\.aspx\?market\=Cinema { return 301 $scheme://$http_host/applications/installed; }
  location ~* (?i)/market\.aspx\?market\=RecordingBroadcast { return 301 $scheme://$http_host/applications/studio; }
  location ~* (?i)/market\.aspx\?market\=Tour { return 301 $scheme://$http_host/applications/live-sound; }

  location ~* (?i)/News\.aspx { return 301 http://harmanprogroup.blogspot.com/; }
  location ~* (?i)/PressRelease\.aspx.* { return 301 http://harmanprogroup.blogspot.com/; }

}
