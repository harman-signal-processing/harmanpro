<script type="text/ng-template" id="venue_popup">
  <div class="triangle"></div>
  <div class="ns-popover-tooltip">
    <div class="row collapse">
      <div class="large-11 small-11 columns">
        <h5 class="subheader">{{ venue.name }}</h5>
      </div>
      <div class="large-1 small-1 columns text-right">
        <a ng-click="hidePopover()"><%= image_tag('close.png', alt: "X") %></a>
      </div>
    </div>
    <p>{{ venue.description }}</p>
  </div>
</script>

<div ng-controller="HomepageBannerCtrl as banner" locale="<%= I18n.locale %>">
  <div class="bumped-up">
    <div class="banner-container text-center" style="background: white">
      <h1 class="homepage-banner"><%=raw format_headline SiteSetting.value("homepage-main-headline") %></h1>
      <div class="slick-show">
        <div class="text-center homepage-banner">
          <%= image_tag "HarmanSkylineImage.jpg" %>
          <img src="<%= asset_path('H-Pointer.png') %>" alt="[H]" class="help-icon animated bounceIn hide-for-small-down" ns-popover
            ng-repeat="venue in venues"
            vid="{{ venue.id }}"
            ng-style="{'left': venue.left, 'top': venue.top, '-moz-animation-delay': venue.id*2/5+'s', '-animation-delay': venue.id*2/5+'s', '-webkit-animation-delay': venue.id*2/5+'s'}"
            ns-popover-modal="venue-popups"
            ns-popover-theme="ns-popover-tooltip-theme"
            ns-popover-template="venue_popup"/>
        </div>
        <% @slides.each do |slide| %>
          <div class="slick-slide">
            <% if slide.link_url.present? %>
              <%= link_to slide.link_url, target: (slide.link_new_window?) ? "_blank" : "" do %>
                <%= image_tag slide.background.url, alt: slide.name %>
              <% end %>
            <% else %>
              <%= image_tag slide.background.url, alt: slide.name %>
            <% end %>
          </div>
        <% end %>
      </div>
    </div>
  </div>
</div>

<div class="container main-container">
  <p>&nbsp;</p>

  <% if @featured_case_studies.length > 0 %>
    <p>&nbsp;</p>
    <div class="row">
      <div class="large-12 columns">
        <h2 class="text-center">
          <%= SiteSetting.value("homepage-case-studies-headline") %>
        </h2>
        <div class="case_studies">
          <ul class="small-block-grid-1 large-block-grid-4 medium-block-grid-2">
            <% @featured_case_studies[0,4].each do |case_study| %>
              <li>
                <%= render "shared/case_study_summary", case_study: case_study %>
              </li>
            <% end %>
          </ul>
        </div>
      </div>
    </div>
  <% end %>

  <div class="row">
    <div class="small-12 columns">
      <div class="row collapse">
        <% @vertical_markets.each do |vm| %>
          <div class="medium-6 small-12 columns">
            <div class="vm-big-button" data-background="<%= vm.background.url %>">
              <div class="text-center">
                <h6><%= t('explore') %></h6>
                <h3><%= link_to vm do %><%= t('vertical_market_solutions', vertical_market_name: vm.name) %><% end %></h3>
              </div>
              <div class="overlay">
                <h4><%= link_to vm do %><%= t('vertical_market_solutions', vertical_market_name: vm.name) %><% end %></h4>
                <ul class="medium-block-grid-<%= vm.children_or_reference_systems.in_groups_of(max_items_in_top_nav_columns + 2).length %>">
                  <% vm.children_or_reference_systems.in_groups_of(max_items_in_top_nav_columns + 2) do |group| %>
                    <li>
                      <ul><% group.each do |item| %>
                        <%= menu_link_for(item) if item.respond_to?(:name) %>
                      <% end %></ul>
                    </li>
                  <% end %>
                </ul>
              </div>
            </div>
          </div>
        <% end %>
      </div>
    </div>
  </div>

  <p>&nbsp;</p>
  <div class="row">
    <div class="large-12 columns">
      <div class="site-resources-container" data-equalizer="site-resource-panels">
        <ul class="small-block-grid-1 large-block-grid-4 medium-block-grid-2">
          <li>
            <div class="blue panel" data-equalizer-watch="site-resource-panels">
              <div class="img_container">
                <% if SiteSetting.set_for_locale?("blog_link_name") && SiteSetting.set_for_locale?("blog_link") %>
                  <%= link_to SiteSetting.value("blog_link"), target: "_blank" do %>
                    <%= image_tag('insights_thumbnail.jpg', alt: SiteSetting.value("blog_link_name")) %>
                  <% end %>
                <% else %>
                  <%= link_to news_articles_path do %>
                    <%= image_tag('default_news_thumbnail.jpg', alt: "News") %>
                  <% end %>
                <% end %>
              </div>
              <h6><%= t('nav.news') %>:</h6>
              <% if SiteSetting.set_for_locale?("blog_link_name") && SiteSetting.set_for_locale?("blog_link") %>
                <h4><%= link_to SiteSetting.value("blog_link"), target: "_blank" do %>
                  <%= t('site_name') %>
                  <%= SiteSetting.value("blog_link_name") %>
                  <% end %>
                </h4>
              <% else %>
                <h4><%= link_to news_articles_path do %>Click here for the latest news from HARMAN.<% end %></h4>
              <% end %>
            </div>
          </li>
          <li>
            <div class="blue panel" data-equalizer-watch="site-resource-panels">
              <div class="img_container">
                <% if @event %>
                  <%= link_to @event do %>
                    <%= image_tag(@event.image.url(:medium), alt: "Events") %>
                  <% end %>
                <% else %>
                  <%= link_to events_path do %>
                    <%= image_tag('default_events_thumbnail.jpg', alt: "Events") %>
                  <% end %>
                <% end %>
              </div>
              <h6><%= t('nav.events') %>:</h6>
              <% if @event %>
                <h4><%= link_to @event do %>
                  <%= @event.name.truncate(35) %><br/>
                  <%= l @event.start_on, format: :short %> - <%= l @event.end_on, format: :short %>
                <% end %>
                </h4>
              <% else %>
                <h4><%= link_to events_path do %>Click here for the latest HARMAN events.<% end %></h4>
              <% end %>
            </div>
          </li>
          <li>
            <div class="blue panel" data-equalizer-watch="site-resource-panels">
              <% if I18n.locale.to_s.match(/zh/i) %>
                <div class="img_container">
                  <%= link_to media_library_path do %>
                    <div class="media-library-banner"></div>
                  <% end %>
                </div>
                <h6><%= t('nav.resources') %>:</h6>
                <h4><%= link_to t('nav.media_library'), media_library_path %></h4>
              <% else %>
                <div class="img_container">
                  <%= link_to 'https://www.linkedin.com/company/10201306', target: "_blank" do %>
                    <div class="linkedin-banner"></div>
                  <% end %>
                </div>
                <h6><%= t('nav.resources') %>:</h6>
                <h4><%= link_to "#{t('site_name')} on LinkedIn", 'https://www.linkedin.com/company/10201306', target: "_blank" %></h4>
              <% end %>
            </div>
          </li>
          <li>
            <div class="blue panel" data-equalizer-watch="site-resource-panels">
              <div class="img_container">
                <%= link_to service_path do %>
                  <div class="service-banner"></div>
                <% end %>
              </div>
              <h6><%= t('nav.service') %>:</h6>
              <h4><%= link_to SiteSetting.value("service-page-harman-pro-dealer-portal-subheader"), service_path %></h4>
            </div>
          </li>
        </ul>
      </div>
    </div>
  </div>

</div>

<% if SiteSetting.set_for_locale?("store_link", current_locale.key) %>
<div class="row collapse">
  <div class="small-12 columns">
    <div class="ecomm-strip">
      <div class="row collapse">
        <div class="medium-6 columns">
          <%= link_to SiteSetting.value("store_link") do %>
            <%= image_tag "shop_banner_bg.jpg", alt: "Shop HARMAN direct" %>
          <% end %>
        </div>
        <div class="medium-5 small-12 columns text-center cta">
          <h3><%= raw format_headline SiteSetting.value("homepage-ecommerce-headline") %></h3>
          <p><%= raw SiteSetting.value("homepage-ecommerce-text") %></p>
          <p><%= link_to t('home_page.shop_now'), SiteSetting.value("store_link"), target: "_blank", class: "small radius button" %></p>
        </div>
        <div class="medium-1 hide-for-small columns">&nbsp;</div>
      </div>
    </div>
  </div>
</div>
<% end %>

<% if SiteSetting.set?("homepage-roadblock") %>
  <div id="roadblock" class="reveal-modal medium" data-reveal aria-labelledby="Offer" aria-hidden="true" role="dialog">
    <a class="close-reveal-modal" aria-label="Close">&#215;</a>
    <%= raw SiteSetting.value("homepage-roadblock") %>
  </div>
<% end %>


